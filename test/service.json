{
  "name": "MasterData",
  "description": "Сервия обмена данными с 1с",
  "methods": {
    "CreateOrder": {
      "action": "CreateOrder",
      "description": "Создать заказа",
      "request": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          }
        },
        "required": [
          "id"
        ]
      },
      "response": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          }
        },
        "required": [
          "status"
        ]
      }
    }
  },
  "events": {
    "list": {
      "New": {
        "action": "New",
        "options": {
          "stream": true
        },
        "description": "Создание нового заказа в системе",
        "event": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "orderId": {
              "type": "string"
            },
            "status": {
              "type": "string",
              "enum": [
                "N"
              ]
            },
            "subStatus": {
              "type": "string",
              "enum": [
                "awaiting_confirmation"
              ]
            },
            "partnerId": {
              "type": "string"
            },
            "externalId": {
              "type": "string"
            },
            "organization": {
              "type": "string"
            },
            "inn": {
              "type": "number"
            },
            "name": {
              "type": "string"
            },
            "email": {
              "type": "string"
            },
            "transactions": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "REGISTER_POSITION"
                    ]
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "n"
                    ]
                  },
                  "code": {
                    "type": "string"
                  },
                  "articul": {
                    "type": "string"
                  },
                  "barcode": {
                    "type": "string"
                  },
                  "info": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "fullName": {
                        "type": "string"
                      },
                      "brand": {
                        "type": "string"
                      },
                      "manufacturer": {
                        "type": "string"
                      },
                      "measure": {
                        "type": "string"
                      }
                    }
                  },
                  "quantity": {
                    "type": "number"
                  },
                  "price": {
                    "type": "number"
                  },
                  "partnerPrice": {
                    "type": "number"
                  },
                  "totalSum": {
                    "type": "number"
                  }
                },
                "required": [
                  "id",
                  "type",
                  "status",
                  "code",
                  "articul",
                  "barcode",
                  "quantity",
                  "price",
                  "partnerPrice",
                  "totalSum"
                ]
              }
            },
            "totalSum": {
              "type": "number"
            },
            "totalDiscountSum": {
              "type": "number"
            },
            "resultSum": {
              "type": "number"
            },
            "deliveryAddress": {
              "type": "string"
            },
            "deliveryPrice": {
              "type": "number"
            },
            "createdBy": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                },
                "type": {
                  "type": "string",
                  "enum": [
                    "p",
                    "pe"
                  ]
                },
                "name": {
                  "type": "string"
                },
                "surname": {
                  "type": "string"
                },
                "email": {
                  "type": "string"
                },
                "patronymic": {
                  "type": "string"
                },
                "phone": {
                  "type": "string"
                }
              },
              "required": [
                "id",
                "type",
                "name",
                "surname",
                "email"
              ]
            },
            "created": {
              "type": "string",
              "format": "date-time"
            },
            "UTSOffsetInHours": {
              "type": "number"
            },
            "comment": {
              "type": "string"
            }
          },
          "required": [
            "id",
            "orderId",
            "partnerId",
            "externalId",
            "organization",
            "inn",
            "name",
            "email",
            "transactions",
            "totalSum",
            "totalDiscountSum",
            "resultSum",
            "deliveryAddress",
            "createdBy",
            "created",
            "UTSOffsetInHours"
          ]
        }
      },
      "Update": {
        "action": "Update",
        "options": {
          "stream": true
        },
        "description": "Обновление заказа",
        "event": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "orderId": {
              "type": "string"
            },
            "status": {
              "type": "string",
              "enum": [
                "U",
                "C",
                "F"
              ]
            },
            "subStatus": {
              "type": "string",
              "enum": [
                "work_in_progress",
                "write_error",
                "cancel",
                "finish"
              ]
            },
            "partnerId": {
              "type": "string"
            },
            "externalId": {
              "type": "string"
            },
            "organization": {
              "type": "string"
            },
            "inn": {
              "type": "number"
            },
            "name": {
              "type": "string"
            },
            "email": {
              "type": "string"
            },
            "transactions": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "REGISTER_POSITION"
                    ]
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "n",
                      "u",
                      "c",
                      "f"
                    ]
                  },
                  "code": {
                    "type": "string"
                  },
                  "articul": {
                    "type": "string"
                  },
                  "barcode": {
                    "type": "string"
                  },
                  "info": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "fullName": {
                        "type": "string"
                      },
                      "brand": {
                        "type": "string"
                      },
                      "manufacturer": {
                        "type": "string"
                      },
                      "measure": {
                        "type": "string"
                      }
                    }
                  },
                  "quantity": {
                    "type": "number"
                  },
                  "price": {
                    "type": "number"
                  },
                  "partnerPrice": {
                    "type": "number"
                  },
                  "totalSum": {
                    "type": "number"
                  }
                },
                "required": [
                  "id",
                  "type",
                  "status",
                  "code",
                  "articul",
                  "barcode",
                  "quantity",
                  "price",
                  "partnerPrice",
                  "totalSum"
                ]
              }
            },
            "totalSum": {
              "type": "number"
            },
            "totalDiscountSum": {
              "type": "number"
            },
            "resultSum": {
              "type": "number"
            },
            "deliveryAddress": {
              "type": "string"
            },
            "deliveryPrice": {
              "type": "number"
            },
            "createdBy": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                },
                "type": {
                  "type": "string",
                  "enum": [
                    "p",
                    "pe"
                  ]
                },
                "name": {
                  "type": "string"
                },
                "surname": {
                  "type": "string"
                },
                "email": {
                  "type": "string"
                },
                "patronymic": {
                  "type": "string"
                },
                "phone": {
                  "type": "string"
                }
              },
              "required": [
                "id",
                "type",
                "name",
                "surname",
                "email"
              ]
            },
            "created": {
              "type": "string",
              "format": "date-time"
            },
            "UTSOffsetInHours": {
              "type": "number"
            },
            "comment": {
              "type": "string"
            },
            "changes": {
              "type": "object",
              "properties": {
                "createdBy": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "type": {
                      "type": "string",
                      "enum": [
                        "p",
                        "pe",
                        "e"
                      ]
                    },
                    "name": {
                      "type": "string"
                    },
                    "surname": {
                      "type": "string"
                    },
                    "email": {
                      "type": "string"
                    },
                    "patronymic": {
                      "type": "string"
                    },
                    "phone": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "id",
                    "type",
                    "name",
                    "surname",
                    "email"
                  ]
                },
                "UTSOffsetInHours": {
                  "type": "number"
                },
                "status": {
                  "type": "string",
                  "enum": [
                    "U",
                    "C",
                    "F"
                  ]
                },
                "subStatus": {
                  "type": "string",
                  "enum": [
                    "work_in_progress",
                    "write_error",
                    "cancel",
                    "finish"
                  ]
                },
                "transactions": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "type": {
                        "type": "string",
                        "enum": [
                          "REGISTER_POSITION"
                        ]
                      },
                      "status": {
                        "type": "string",
                        "enum": [
                          "n",
                          "u",
                          "c",
                          "f"
                        ]
                      },
                      "code": {
                        "type": "string"
                      },
                      "articul": {
                        "type": "string"
                      },
                      "barcode": {
                        "type": "string"
                      },
                      "info": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "fullName": {
                            "type": "string"
                          },
                          "brand": {
                            "type": "string"
                          },
                          "manufacturer": {
                            "type": "string"
                          },
                          "measure": {
                            "type": "string"
                          }
                        }
                      },
                      "quantity": {
                        "type": "number"
                      },
                      "price": {
                        "type": "number"
                      },
                      "partnerPrice": {
                        "type": "number"
                      }
                    },
                    "required": [
                      "id",
                      "type"
                    ]
                  }
                },
                "deliveryAddress": {
                  "type": "string"
                }
              },
              "required": [
                "createdBy",
                "UTSOffsetInHours"
              ]
            }
          },
          "required": [
            "id",
            "orderId",
            "partnerId",
            "externalId",
            "organization",
            "inn",
            "name",
            "email",
            "transactions",
            "totalSum",
            "totalDiscountSum",
            "resultSum",
            "deliveryAddress",
            "createdBy",
            "created",
            "UTSOffsetInHours",
            "change"
          ]
        }
      }
    },
    "streamOptions": {
      "prefix": "stream",
      "actions": [
        {
          "action": "*",
          "storage": "file",
          "retentionPolicy": "limits",
          "discardPolicy": "old",
          "messageTTL": 1209600,
          "duplicateTrackingTime": 86400,
          "replication": 1,
          "rollUps": true
        }
      ]
    }
  }
}
